import supertest from 'supertest';
import app from '../src/app';
import { genToken } from '../src/lib/authTools';

describe('CATEGORY', () => {
    let token = '';
    beforeAll(() => {
        token = genToken({
            id: 1,
            pseudo: 'dudul',
            email: 'fgdsgf@dsf.sdf',
            password: 'ddd',
            role: 'USER',
        });
    });

    describe('get all categories', () => {
        it('should return 200', async () => {
            await supertest(app)
                .get('/api/v1/categories')
                .set({ Authorization: 'Bearer ' + token })
                .expect(200)
                .then((response) => {
                    // console.log(response.body);
                });
        });
    });

    describe('get category by id', () => {
        it('should return 200 (category tab)', async () => {
            await supertest(app)
                .get('/api/v1/categories/1')
                .set({ Authorization: 'Bearer ' + token })
                .expect(200)
                .then((response) => {
                    expect(response.body.name).toBe('Ore');
                });
        });

        it('should return 404 (not found)', async () => {
            await supertest(app)
                .get('/api/v1/categories/10000000000000')
                .set({ Authorization: 'Bearer ' + token })
                .expect(404)
                .then((response) => {
                    // expect(response.body.name).toBe('Resources');
                });
        });
    });
});
